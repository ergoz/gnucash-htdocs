<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>18.1. Importare fatture e ricevute</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Guida ai concetti e manuale di GnuCash"><link rel="up" href="ch_import_busisness_data.html" title="Capitolo 18. Importare i dati dell’impresa"><link rel="prev" href="ch_import_busisness_data.html" title="Capitolo 18. Importare i dati dell’impresa"><link rel="next" href="import-customers-vendors.html" title="18.2. Importare clienti e venditori"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">18.1. Importare fatture e ricevute</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch_import_busisness_data.html">&lt;&lt;&lt; Indietro</a> </td><th width="60%" align="center">Capitolo 18. Importare i dati dell’impresa</th><td width="20%" align="right"> <a accesskey="n" href="import-customers-vendors.html">Avanti &gt;&gt;&gt;</a></td></tr></table><hr></hr></div><div class="sect1" title="18.1. Importare fatture e ricevute"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="import-invoices"></a>18.1. Importare fatture e ricevute</h2></div></div></div><p>L’importatore di clienti è venditori è un modulo opzionale e deve essere abilitato aggiungendo la seguente riga al file <code class="filename">$HOME/.gnucash/config.user</code>:</p><p><code class="code">(gnc:module-load "gnucash/plugins/bi_import" 0)</code></p><p>Su sistemi Linux questo file è <code class="filename">$HOME/.gnucash/config.user</code> e su MacOSX <code class="filename">~/Library/Application Support/GnuCash/config.user</code>. Se il file non esiste già, lo si dovrà creare. Dopo aver riavviato <strong class="application"><code>GnuCash</code></strong> l’elemento comparirà alla fine del menu <span class="guimenu"><strong>Impresa</strong></span>.</p><p>Perchè l’importatore funzioni correttamente, i dati devono essere in formato a lunghezza fissa di campo, o separati da virgole. Uno script di <strong class="application"><code>Python</code></strong> è fornito di seguito come esempio.</p><p>
      </p><pre class="programlisting">
import sys
import csv

VENDOR_ID="000013"
INFILE=sys.argv[1]
INV_ID=sys.argv[2]
try:
  ACCOUNT=sys.argv[3]
except:
  ACCOUNT="Expenses:Materials General"

Reader = csv.reader(open(INFILE), delimiter=',')

# Need to ignore 1st and last rows

for row in Reader:
  if row[0].isdigit(): # We only use numbered lines
    outline=(INV_ID + ",," + VENDOR_ID + ",,,," + row[1] + " &gt; " + row[4] + ",ea," +
      ACCOUNT + "," + row[2] + "," + row[5].replace("GBP", "") + ",,,,no,,,,,,,")
  print outline
      </pre><p>
    </p><p>Esempio di un file d’ordine del fornitore scaricato da <span class="emphasis"><strong>Rapid Electronics (UK)</strong></span>. </p><pre class="programlisting">
line number,product code,quantity,availability,product description,unit price,discounts,line total,delivery,sub total,vat,grand total
1,47-3524,100,100 Available,BC848C SOT-23 NPN TRANSISTOR (INF) (RC),GBP0.03,GBP0.00,GBP0.03
2,47-3278,30,30 Available,L78L05ACZ 0.1A +5V VOLTAGE REG (ST) (RC),GBP0.18,GBP0.00,GBP0.18
3,22-0120,1,1 Available,Tube 34 14pin DIL socket, narrow7.62mm, without central support,GBP1.05,GBP0.00,GBP1.05
4,22-0127,1,0 Available&lt;br /&gt;1 on Back Order,Tube 17 28pin DIL socket, wide15.24mm, without central support,GBP1.22,GBP0.00,GBP1.22
5,62-0368,1,1 Available,820R CR25 0.25W CF Resistor Pk 100,GBP0.50,GBP0.00,GBP0.50
6,47-3130,100,100 Available,1N4001 1A 50V SILICON RECTIFIER DIODE RC,GBP0.01,GBP0.00,GBP0.01
7,17-0310,1,1 Available,PROFESSIONAL MINATURE PROBE HOOK RED RC,GBP0.90,GBP0.00,GBP0.90
8,17-0312,1,1 Available,PROFESSIONAL MINATURE PROBE HOOK BLACKRC,GBP0.90,GBP0.00,GBP0.90
9,34-0655,1,1 Available,PROTOBLOC 2 BREADBOARD,GBP4.39,GBP0.00,GBP4.39
10,18-0200,1,1 Available,PP3 9V ALKALINE BATTERY "Not For Retail Sale",GBP1.37,GBP0.00,GBP1.37
,,,,,,,,GBP4.95,GBP24.93,GBP4.35,GBP29.28
      </pre><p>Un file simile dopo essere stato processato con lo script di <strong class="application"><code>Python</code></strong>.</p><p>
        </p><pre class="programlisting">
MEC-0071,,000013,,,,34-0655 &gt; PROTOBLOC 2 BREADBOARD,ea,Expenses:Materials General,1,4.39,,,,no,,,,,,,
MEC-0071,,000013,,,,18-0105 &gt; PP3 / PP6 BATTERY CLIP 150MM (RC),ea,Expenses:Materials General,10,0.06,,,,no,,,,,,,
MEC-0071,,000013,,,,62-0370 &gt; 1k CR25 0.25W CF Resistor Pk 100,ea,Expenses:Materials General,1,0.50,,,,no,,,,,,,
MEC-0071,,000013,,,,62-0354 &gt; 220R CR25 0.25W CF Resistor Pk 100,ea,Expenses:Materials General,1,0.50,,,,no,,,,,,,
MEC-0071,,000013,,,,34-5548 &gt; PLAIN DOCUMENT WALLET ASSORTED PK 50 RE,ea,Expenses:Materials General,1,6.95,,,,no,,,,,,,
MEC-0071,,000013,,,,62-0386 &gt; 4k7 CR25 0.25W CF Resistor Pk 100,ea,Expenses:Materials General,1,0.50,,,,no,,,,,,,
MEC-0071,,000013,,,,34-0860 &gt; COPPER CLAD SRBP SS 100 X 160 (RC),ea,Expenses:Materials General,5,0.50,,,,no,,,,,,,
MEC-0071,,000013,,,,18-0163 &gt; PP3 BATTERY HOLDER WITH FLYING LEADS RC,ea,Expenses:Materials General,5,0.23,,,,no,,,,,,,
MEC-0071,,000013,,,,73-4290 &gt; ATMEGA8-16PU 8-BIT MICRO 8K DIL-28 (RC),ea,Expenses:Materials General,3,1.99,,,,no,,,,,,,
MEC-0071,,000013,,,,81-0014 &gt; BC108 NPN GP TRANSISTOR RC,ea,Expenses:Materials General,20,0.16,,,,no,,,,,,,
MEC-0071,,000013,,,,DELIVERY,ea,Expenses:Postage,1,4.95,,,,no,,,,,,,
MEC-0071,,000013,,,,VAT,tax,Expenses:VAT,1,4.35,,,,no,,,,,,,
        </pre><p>
    </p><p>Come si può vedere mancano alcuni campi mentre altri non sono necessari per l’importazione. La prima riga e l’ultima sono superflue dato che <strong class="application"><code>GnuCash</code></strong> si prenderà cura di calcolare il totale. Tutto ciò che serve è di prelevare ciò che è necessario e produrre un file di output con il formato corretto per essere importato in <strong class="application"><code>GnuCash</code></strong>. In questo caso i campi del numero dell’elemento (part number) e della descrizione (description) verranno uniti per comporre la descrizione della fattura (o ricevuta) in <strong class="application"><code>GnuCash</code></strong>. Sono necessari il campo della quantità (quantity) e del prezzo (price). Contrariamente alla dicitura dell’intestazione, la <acronym class="acronym">VAT</acronym> non è riportata per ogni riga dato che è sempre 0, ma è calcolata nell’ultima riga sul totale dell’ordine. <div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">Nota</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">Questo causerà problemi in seguito.</p></td></tr></table></div> In questo esempio il conto <span class="emphasis"><strong>Uscite:Materiali generici</strong></span> è stato impostato come conto di destinazione. Questo può essere cambiato dopo l’importazione nel modo usuale, così come qualsiasi altro dato. Se questo conto non esiste, verrà lasciato vuoto durante l’importazione e dovrà essere impostato manualmente. Le righe che iniziano con il simbolo <span class="quote">«<span class="quote">#</span>»</span> sono considerate come commenti e quindi tralasciate.</p><p>Lo script è invocato con il seguente comando:</p><p> <span class="command"><strong>python importer.py <em class="replaceable"><code>file_da_importare</code></em>, <em class="replaceable"><code>invoice_id</code></em> &gt; <em class="replaceable"><code>file_in_cui_salvare.csv</code></em></strong></span>
      </p><p>Questo breve script può facilmente essere modificato per adattarlo a qualsiasi formato scaricato. L’unica restrizione riguarda il numero di campi che deve essere fisso, almeno al momento. L’importatore ignorerà le righe con un numero errato di campi (questo potrebbe essere corretto nelle versioni future). L’ID venditore è semplicemente il numero identificativo assegnato a quello specifico venditore. Gli elementi row[N] si riferiscono alla posizione dove sono presenti i dati. È importante notare come il primo campo sia row[0] e non row[1].</p><p>Una volta che il file è stato convertito, selezionare <span class="guimenu"><strong>Impresa</strong></span> → <span class="guimenuitem"><strong>Importa fatture e ricevute</strong></span> per aprire una nuova finestra di importazione. Selezionare il file appena creato, selezionare poi <span class="guilabel"><strong>fattura</strong></span> o <span class="guilabel"><strong>ricevuta</strong></span> e il formato <span class="guilabel"><strong>separato da virgole</strong></span>. Controllare che i dati dei campi siano nelle colonne corrette prima di selezionare <span class="guibutton">OK</span>. Una volta importata la fattura può essere aperta per modificarla o per emetterla nel modo usuale.</p><p>Una nota sulla <acronym class="acronym">VAT</acronym> o qualsiasi altra imposta sugli acquisti. Come già detto, <span class="emphasis"><strong>Rapid Electronics</strong></span> calcola la <acronym class="acronym">VAT</acronym> sul totale della ricevuta e non per ogni riga. <strong class="application"><code>GnuCash</code></strong> calcola la <acronym class="acronym">VAT</acronym> per ogni riga e ne fai poi il totale. Questa differenza può comportare delle inaccuratezze nell’importo della <acronym class="acronym">VAT</acronym> di alcuni centesimi che sono sufficienti a causare problemi in fase di riconciliazione del conto usato per l’acquisto. Al momento il superamento del problema dipende solamente dal proprio modo preferito; ad esempio la <acronym class="acronym">VAT</acronym> può essere aggiunta manualmente in una riga separata come i costi di spedizione. QUindi parte del lavoro è lasciata all’utente ma la parte più noiosa di inserimento di ogni elemento è eliminata.</p><p>Per il fututro: attualmente il formato di importazione è ristertto e diversi utenti potrebbero andare incontro a dei problemi durante il processo di conversione. Aggiungere un modello per ogni possibile formato <acronym class="acronym">CSV</acronym> dei fornitori sarebbe un lavoro enorme e probabilmente infruttuoso dato che molti fornitori spesso cambiano formato senza avvertire gli sviluppatori di <strong class="application"><code>GnuCash</code></strong>. I miglioramenti futuri del processo di importazione saranno basati sui consigli degli utenti e probabilemente verrà reso più semplice o flessibile (spesso <span class="quote">«<span class="quote">semplice</span>»</span> non è compatibile con <span class="quote">«<span class="quote">flessibile</span>»</span>).</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">Nota</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">Se non si ha dimestichezza con <strong class="application"><code>Python</code></strong> (esistono altri linguaggi), è possibile inviare una richiesta alla <a class="ulink" href="https://lists.gnucash.org/mailman/listinfo/gnucash-user" target="_top"><em class="citetitle">lista dell’utente di GnuCash</em>, con un esempio del proprio file <acronym class="acronym">CSV</acronym> scaricato, e probabilmente qualcuno si preoccuperà di scrivere uno script di <strong class="application"><code>Python</code></strong> per la sua traduzione.</a></p></td></tr></table></div><div class="sect2" title="18.1.1. Note per gli autori Python"><div class="titlepage"><div><div><h3 class="title"><a name="python-author-notes"></a>18.1.1. Note per gli autori <strong class="application"><code>Python</code></strong></h3></div></div></div><p>Per poter completare con successo il processo di importazione, il numero di campi deve essere rispettato, quindi le virgole sono importanti.</p><p>Di seguito è riportato un elenco completo dei campi necessari:</p><p>id, date_opened, owner_id, billingid, notes, date, desc, action, account, quantity, price, disc_type, disc_how, discount, taxable, taxincluded, tax_table, date_posted, due_date, account_posted, memo_posted, accu_splits,</p><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:doc="http://nwalsh.com/xsl/documentation/1.0" class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0"><tr><td rowspan="2" align="center" valign="top" width="25"><img src="./stylesheet/note.png"></img></td><th align="left" valign="top">Nota</th></tr><tr><td colspan="2" align="left" valign="top"><p xmlns="">Si noti la virgola finale</p></td></tr></table></div></div><div class="sect2" title="18.1.2. Una breve descrizione di ogni campo"><div class="titlepage"><div><div><h3 class="title"><a name="python-import-fields"></a>18.1.2. Una breve descrizione di ogni campo</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><strong>id</strong></span> - il numero della fattura. Tutte le righe devono contenerlo o la riga verrà rifiutata.</p></li><li class="listitem"><p><span class="emphasis"><strong>date_opened</strong></span> - data di apertura. Se vuota viene inserita la data odierna.</p></li><li class="listitem"><p><span class="emphasis"><strong>owner_id</strong></span> - numero ID del venditore o del cliente. Tutte le righe devono contenere questo valore altrimenti verranno rifiutate.</p></li><li class="listitem"><p><span class="emphasis"><strong>billingid</strong></span> — ID ricevuta.</p></li><li class="listitem"><p><span class="emphasis"><strong>notes</strong></span> — note della fattura.</p></li><li class="listitem"><p><span class="emphasis"><strong>date</strong></span> - la dta dell’elemento sulla riga. Può essere lasciata vuota per considerarla in data odierna.</p></li><li class="listitem"><p><span class="emphasis"><strong>desc</strong></span> - descrizione della fattura o della ricevuta</p></li><li class="listitem"><p><span class="emphasis"><strong>action</strong></span> - per le ricevute normalmente è <span class="quote">«<span class="quote">ea</span>»</span>.</p></li><li class="listitem"><p><span class="emphasis"><strong>account</strong></span> - il conto a cui è attribuito l’elemento.</p></li><li class="listitem"><p><span class="emphasis"><strong>quantity</strong></span> - quantità di ogni elemento. Deve contenere un valore o la riga verrà rifiutata.</p></li><li class="listitem"><p><span class="emphasis"><strong>price</strong></span> - prezzo di ogni elemento. Deve contenere un valore o la riga verrà rifiutata.</p></li><li class="listitem"><p><span class="emphasis"><strong>disc_type</strong></span> - tipo di sconto; può essere <span class="quote">«<span class="quote">%</span>»</span> o <span class="quote">«<span class="quote">TODO</span>»</span>. Si applica solo alle fatture. È necessario fare qualche prova in questo caso dato che può essere funzione della valuta.</p></li><li class="listitem"><p><span class="emphasis"><strong>disc_how</strong></span> - si applica solamente alle fatture.</p></li><li class="listitem"><p><span class="emphasis"><strong>discount</strong></span> - importo dello sconto applicato. Si applica solamente alle fatture.</p></li><li class="listitem"><p><span class="emphasis"><strong>taxable</strong></span> - applicare le imposte all’elemento? <span class="quote">«<span class="quote">y</span>»</span> o vuoto.</p></li><li class="listitem"><p><span class="emphasis"><strong>taxincluded</strong></span> - le imposte sono incluse nel prezzo dell’elemento? <span class="quote">«<span class="quote">y</span>»</span> o vuoto.</p></li><li class="listitem"><p><span class="emphasis"><strong>tax_table</strong></span> — tabella delle imposte da applicare all’elemento.</p></li><li class="listitem"><p><span class="emphasis"><strong>date_posted</strong></span> - se emessa, in che data. Normalmente è lasciato vuoto per l’emissione manuale dopo aver modificato la fattura.</p></li><li class="listitem"><p><span class="emphasis"><strong>due_date</strong></span> - la data in cui è fissata la scadenza del pagamento.</p></li><li class="listitem"><p><span class="emphasis"><strong>account_posted</strong></span> — conto di emissione.</p></li><li class="listitem"><p><span class="emphasis"><strong>memo_posted</strong></span> - se emessa, inserire qui il promemoria.</p></li><li class="listitem"><p><span class="emphasis"><strong>accu_splits</strong></span> — accumulare le suddivisioni? <span class="quote">«<span class="quote">y</span>»</span> o vuoto.</p></li></ul></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch_import_busisness_data.html">&lt;&lt;&lt; Indietro</a> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Partenza</a></td><td width="40%" align="right"> <a accesskey="n" href="import-customers-vendors.html">Avanti &gt;&gt;&gt;</a></td></tr><tr><td width="40%" align="left">Capitolo 18. Importare i dati dell’impresa </td><td width="20%" align="center"><a accesskey="u" href="ch_import_busisness_data.html">Risali</a></td><td width="40%" align="right"> 18.2. Importare clienti e venditori</td></tr></table></div></body></html>
